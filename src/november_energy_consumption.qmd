---
title: "November Energy Report"
format:
  html:
    code-fold: true
    toc: true
    number-sections: true
    theme: zephyr
    embed-resources: true
  gfm: default
jupyter: python3
---

```{python}
import pandas as pd
from great_tables import GT, md
from EnergyConsumption import EnergyConsumption, generate_default_consumption_pattern_gas, generate_default_consumption_pattern_electricity_day, generate_default_consumption_pattern_electricity_night, plot_default_consumption_pattern
```

## Calculate yearly energy consumption
```{python}
energy_consumption = EnergyConsumption()
```

### VREG API
Based on the default inputs, the VREG estimates a yearly consumption as indicated below.
```{python}
df_VREG = pd.DataFrame(data = {
  'Day': [energy_consumption.default_VREG['Day']],
  'Night': [energy_consumption.default_VREG['Night']],
  'Gas': [energy_consumption.default_VREG['Gas']]})

(
    GT(df_VREG)
    .tab_header(
        title=md("Estimated yearly consumption based on VREG"),
        subtitle=md("*In kWh*"),
    )
    .cols_label(
        Day="Electricity Day",
        Night="Electricity Night",
        Gas="Gas",
    )
    .cols_align("center")
    .fmt_integer(sep_mark='.')
)
```

### Energy consumption pattern - extrapolated

In case no full history of the energy consumption is available, data will be extrapolated based on the below pattern. This is the actual consumption of a house in Belgium.

```{python}
plot_default_consumption_pattern(generate_default_consumption_pattern_gas())
plot_default_consumption_pattern(generate_default_consumption_pattern_electricity_day())
plot_default_consumption_pattern(generate_default_consumption_pattern_electricity_night())
```

### Energy consumption pattern - actuals

### Result